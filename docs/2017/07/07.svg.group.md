SVG中的结构化、分组和引用元素
===

SVG 有自己结构化文档的方式。

通过某些 SVG 元素，我们可以在文档中定义、分组以及引用对象。这些元素使得元件重用变得简单，而且还保持了代码的简洁性和可读性。


## 使用 `<g>` 元素分组
`<g>` 代表 group（分组），分组元素用于在逻辑上对相关的图形元素进行分组。

`<g>` 元素将其所有子内容分到一组，它通常有一个 id 属性，用来给分组命名。同时，给 `<g>` 元素应用的样式也都会被应用于它所有的子元素。

例如，下面是一个SVG绘制的鸟的图。这只鸟是用几个简单的形状组合完成的，包括圆和路径。

![SVG Bird](http://www.w3cplus.com/sites/default/files/blogs/2015/1508/grouping-bird.svg)

在这个示例中，我们和身体部分的元素放一个组，头部的元素放一个组，然后将这两组内容再放到一个组中，赋予 id 为 bird。
```html
<svg width="400" height="400px" viewBox="0 0 200 200">
    <g id="bird">
        <g id="body">
            <path d="M48.42,78.11c0-17.45,14.14-31.58,31.59-31.58s31.59,14.14,31.59,31.58c0,17.44-14.14,31.59-31.59,31.59 S48.42,95.56,48.42,78.11"
            />
            <path d="M109.19,69.88c0,0-8.5-27.33-42.51-18.53c-34.02,8.81-20.65,91.11,45.25,84.73 c40.39-3.65,48.59-24.6,48.59-24.6S124.68,106.02,109.19,69.88"
            />
            <path id="wing" d="M105.78,75.09c4.56,0,8.84,1.13,12.62,3.11c0,0,0.01-0.01,0.01-0.01l36.23,12.38c0,0-13.78,30.81-41.96,38.09 c-1.51,0.39-2.82,0.59-3.99,0.62c-0.96,0.1-1.92,0.16-2.9,0.16c-15.01,0-27.17-12.17-27.17-27.17 C78.61,87.26,90.78,75.09,105.78,75.09"
            />
        </g>
        <g id="head">
            <path id="beak" d="M50.43,68.52c0,0-8.81,2.58-10.93,4.86l9.12,9.87C48.61,83.24,48.76,74.28,50.43,68.52" />
            <path class="eye-ball" d="M60.53,71.68c0-6.33,5.13-11.46,11.46-11.46c6.33,0,11.46,5.13,11.46,11.46c0,6.33-5.13,11.46-11.46,11.46 C65.66,83.14,60.53,78.01,60.53,71.68"
            />
            <path id="pupil" d="M64.45,71.68c0-4.16,3.38-7.53,7.54-7.53c4.16,0,7.53,3.37,7.53,7.53c0,4.16-3.37,7.53-7.53,7.53 C67.82,79.22,64.45,75.84,64.45,71.68"
            />
            <path class="eye-ball" d="M72.39,74.39c0-2.73,2.22-4.95,4.95-4.95c2.73,0,4.95,2.21,4.95,4.95c0,2.74-2.22,4.95-4.95,4.95 C74.6,79.34,72.39,77.13,72.39,74.39"
            />
        </g>
    </g>
</svg>
```

对各个部分进行样式定义：
```css
svg {background-color: white;}
#wing {fill: #81CCAA;}
#body {fill: #B8E4C2;}
#pupil {fill: #1F2600;}
#beak {fill: #F69C0D;}
.eye-ball {fill: #F6FDC4;}
```

[SVG Bird](https://jsfiddle.net/guihua/73174b8r/)

分组元素非常好用，不仅是因为其组织和结构的特性。当你想要给由几块内容组成的 SVG 图像添加交互或动画的时候，非常好用。你可以把这些内容项放到一个组中，然后给它们定义移动、缩放或旋转的动画，这样它们相互之间的空间关系就可以被保持，也就是位置不会被打乱。

如果你想要对整只鸟进行缩放，让它变成现在尺寸的两倍，只需要一行 CSS 即可完成。
```css
#bird {
    transform: scale(2);
}
```

分组尤其使得交互变得非常方便。你可以将鼠标事件应用到整只鸟上，然后让它作为一整个组去回应事件，而不必给组中的每个元素分别去应用相同的交互或者变换。

`<g>` 元素有一个更重要的特性：它可以有自己的 `<title>` 和 `<desc>` 标签，使其更容易被屏幕阅读器解读，而且代码整体的可读性也更好。例如：
```html
<g id="bird">
    <title>Bird</title>
    <desc>An image of a cute little green bird with an orange beak.</desc>
    <!-- ... -->
</g>
```


## 使用 `<use>` 重用元素
很多时候，在一个图像中，有一些元素是重复使用的。在 Illustrator 中如果你想要重复某个元素，你需要复制该元素，然后把它粘贴到相应的位置。复制粘贴现有元素比重新创建一个相同的元素要方便得多。

`<use>` 元素可以让你重用现有的元素，给你一个类似于图形编辑器中复制粘贴的功能。它可以用于重用单个元素，也可以重用一组用`<g>` 定义的元素。

`<use>` 元素有 `x`，`y`，`height`，`width` 属性，它通过使用 `xlink:href` 属性引用其它内容。所以如果你已经定义了一个分组，并给它赋予了 `id`，当你想要在其它地方使用它时，你只需要在 `xlink:href` 属性中给一个 URI，然后指定 `x` 和 `y` 的位置，也就是该组图像显示的原点 `(0, 0)`。

例如，当我们想要在我们的 SVG 画布上创建另一只鸟时，代码如下：
```html
<use x="100" y="100" xlink:href="#bird" />
```

你可以在 `xlink:href` 属性中引用任何 SVG 元素，即使该元素是存在于外部文件中的。引用的元素和组不需要一定存在于同一个文件中。这对于组织以及缓存文件来说是非常棒的（例如，你可以单独给要用于重用的元素建一个文件）。

例如，如果我们示例中的鸟是在一个单独的叫做 `animals.svg` 的文件中创建的，我们可以像这样引用它：
```html
<use x="100" y="100" xlink:href="path/to/animals.svg#bird" />
```

缺陷：
- 新元素的位置相对于初始元素定位。
- 初始元素的样式不能在新副本中被覆盖。
- 重用use元素会在画布上渲染。


## 使用 `<defs>` 重用已存储元素
`<defs>` 元素可以用来存储那些我们不想直接显示的内容。换句话说，`<defs>` 元素就是用来定义元件，但是不直接渲染。这个隐藏的存储元件可以在后面被其它 SVG 元素应用及显示，这使得它非常适合用于绘制那些包含重用图像的图案。

基本上，任何内容，只要是我们想要定义并保存，然后在后面再使用的，我们都可以在 `<defs>` 中定义，而且该元件可以保存为模板，或是作为一种工具，以便将来使用。模板仅在实例化的时候显示。

下面的示例定义了一个 SVG 渐变，然后把它作为一个简单的 SVG 矩形的填充颜色：
```html
<svg>
    <defs>
        <linearGradient id="gradient">
            <stop offset="0%" style="stop-color: deepPink"></stop>
            <stop offset="100%" style="stop-color: #009966"></stop>
        </linearGradient>
    </defs>

    <rect stroke="#eee" stroke-width="5" fill="url(#gradient)"></rect>
</svg>
```

在 `<defs>` 元素中定义线性渐变，就是确保该渐变不会被渲染，除非它在哪个需要的地方被引用了。


## 使用 `<symbol>` 对元素进行分组
`<symbol>` 元素和 `<g>` 元素相似——它提供了一种对元素进行分组的方式。但是，它和分组元素有两个主要的不同：
- `<symbol>` 元素不会被渲染，在这种方式中实际上它类似于 `<defs>` 元素，只有在 use 时才显示。
- `<symbol>` 元素可以有自己的 `viewBox` 和 `preserveAspectRatio` 属性。也就是它可以适应视窗，然后以你想要的任何方式渲染，而不是都按照默认的样式。

`<symbol>` 非常适用于定义可重复使用的元件（或符号）。它也可以作为 `<use>` 元素实例化的一个模板。而且有 `viewBox` 和`preserveAspectRatio` 属性，它可以在引用 `<use>` 元素定义的矩形视窗中自适应缩放。注意 symbol 元素每次被 use 元素实例化时都可以重新定义新的视窗。

注意不能给给 symbol 元素应用 display 属性；因此，即使 display 属性的值设置为 none 之外的其它值，symbol 元素也不能直接渲染。但是即使 symbol 元素的 display 属性或任何它的父元素设置为 none，symbol 元素也可以被引用。